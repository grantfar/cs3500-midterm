<!doctype html>
<html lang="en">
    <head>
        <title>Seabreaze Documentation</title>
        <meta  charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="css/sidebar.css">
        <link rel="stylesheet" href="master.css">
        <link rel="stylesheet" href="css/code.css">
        <script
                src="http://code.jquery.com/jquery-3.3.1.min.js"
                integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
                crossorigin="anonymous"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/panel.js"></script>
    </head>
    <body>

        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <a class="navbar-brand" href="index.html">Seabreeze</a>
                <button class="navbar-toggle navbar-toggle-right" data-target="#navbar-links" data-toggle="collapse" type="button"><span class="glyphicon glyphicon-menu-hamburger
                    "></span></button>
                <div class="collapse navbar-collapse" id="navbar-links">
                    <ul class="nav navbar-nav">
                        <li><a>Installation</a></li>
                        <li><a>about</a></li>
                        <li><a>Voting</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="container">
            <div class="panel panel default">
                <div class="row panel-heading" id="example1Head">

                    <div class="col-xs-3"><a href="spectrum.c" download="spectrum.c"><span class="glyphicon glyphicon-download"></span> Download</a></div>
                    <div class="col-xs-1">&nbsp;</div>
                    <div class="col-xs-8"><h4>spectrum.c</h4></div>
                </div>
                <div class="row panel-body" id="example1Body">
                    <div class = "col-xs-1">
                        <code class="lineNumbers">
                            1<br>
                            2<br>
                            3<br>
                            4<br>
                            5<br>
                            6<br>
                            7<br>
                            8<br>
                            9<br>
                            10<br>
                            11<br>
                            12<br>
                            13<br>
                            14<br>
                            15<br>
                            16<br>
                            17<br>
                            18<br>
                            19<br>
                            20<br>
                            21<br>
                            22<br>
                            23<br>
                            24<br>
                            25<br>
                            26<br>
                            27<br>
                            28<br>
                            29<br>
                            30<br>
                            31<br>
                            32<br>
                            33<br>
                            34<br>
                            35<br>
                            36<br>
                            37<br>
                            38<br>
                            39<br>
                            40<br>
                            41<br>
                            42<br>
                            43<br>
                            44<br>
                            45<br>
                            46<br>
                            47<br>
                            48<br>
                            49<br>
                            50<br>
                            51<br>
                            52<br>
                            53<br>
                            54<br>
                            55<br>
                            56<br>
                            57<br>
                            58<br>
                            59<br>
                            60<br>
                            61<br>
                            62<br>
                            63<br>
                        </code>
                    </div>
                    <div class="col-xs-11">
                        <code>
                            /*<br>
                            * This program is the main program we will use at FSR. It takes spectrum readings from the spectrometer and saves them to a file with their corresponding wavelengths.<br>
                            * After these readings are taken, it determines the average spectrum reading and max spectrum reading with its corresponding wavelength.<br>
                            */<br>
                            <br>
                            #include &lt;stdio.h&gt;<br>
                            #include &lt;stdlib.h&gt;<br>
                            #include &lt;string.h&gt;<br>
                            #include &lt;pthread.h&gt;<br>
                            #include &lt;time.h&gt;<br>
                            #include &lt;sys/time.h&gt;<br>
                            #include &lt;errno.h&gt;<br>
                            #include <span class="string">"api/SeaBreezeWrapper.h"</span><br>
                            <br>
                            <span class="declare">int</span> main() {<br>
                            <span class="declare">char</span> fileName[] = { <span class="string">"spectrum.csv"</span> };<br>
                            <br>
                            <span class="declare">double</span> maxSpec = 0;<br>
                            <span class="declare">double</span> avgSpec = 0;<br>
                            <span class="declare">double</span> totalSpec = 0;<br>
                            <span class="declare">double</span> maxWave = 0;<br>
                            <br>
                            <span class="declare">int</span> errorCode;<br>
                            <br>
                            <span class="declare">int</span> open = <span class="reserved">seabreeze_open_spectrometer</span>(0,&amp;errorCode); //Opens device attached to system <span class="reserved">if</span> there is one<br>
                            <span class="reserved">if</span> (open == 1) { //If no device opened, program exits<br>
                            <span class="reserved">printf</span>(<span class="string">"--NO SPECTROMETER FOUND--\n"</span>);<br>
                            return 0;<br>
                            }<br>
                            <br>
                            <span class="declare">char</span> model[16];<br>
                            <span class="declare">int</span> pixels = <span class="reserved">seabreeze_get_formatted_spectrum_length</span>(0, &amp;errorCode); //Acquires a spectrum and returns answer in formatted floats<br>
                            <br>
                            <span class="declare">double</span> *wavelength = (double*) malloc(pixels * <span class="reserved">sizeof</span>(<span class="declare">double</span>));<br>
                            <span class="reserved">seabreeze_get_wavelengths</span>(0,&amp;errorCode,wavelength,pixels); //Computes wavelengths <span class="reserved">for</span> the spectrometer and fills <span class="string">"wavelength" array with those values up to "pixels"</span> value<br>
                            <br>
                            <span class="declare">double</span> *spectrum = (double*) malloc(pixels * <span class="reserved">sizeof</span>(<span class="declare">double</span>));<br>
                            <span class="reserved">seabreeze_get_formatted_spectrum</span>(0,&amp;errorCode,spectrum,pixels); //Acquires the spectrum and returns in formatted floats and places this in the <span class="string">"spectrum" array up to "pixels"</span> value<br>
                            <br>
                            <span class="declare">FILE</span> *csv = fopen(fileName,<span class="string">"w"</span>);<br>
                            <br>
                            <span class="reserved">fprintf</span>(csv, <span class="string">"Wavelength, Spectrum\n"</span>);<br>
                            <span class="reserved">for</span>(<span class="declare">int</span> i = 0; i &lt; pixels; i += 5){<br>
                            <span class="reserved">for</span>(<span class="declare">int</span> k = 0; k &lt; 5 &amp;&amp; k+i&lt;pixels; k++){<br>
                            <span class="reserved">fprintf</span>(csv,<span class="string">"%f,%f\n",wavelength[k+i],spectrum[k+i]); //Writes wavelength and spectrum at each pixel to "spectrum.csv"</span><br>
                            totalSpec += spectrum[k+i];<br>
                            <span class="reserved">if</span> (maxSpec &lt; spectrum[k+i] &amp; k + i &gt; 1) { //Sets maxSpec <span class="reserved">if</span> spectrum reading is higher than other specrum readings, skips first two readings because of bad values<br>
                            maxSpec = spectrum[k+i];<br>
                            maxWave = wavelength[k+i];<br>
                            }<br>
                            }<br>
                            }<br>
                            <br>
                            <span class="reserved">printf</span>(<span class="string">"Output written to \"%s\"\n"</span>, fileName);<br>
                            <br>
                            avgSpec = totalSpec/pixels;<br>
                            <span class="reserved">printf</span>(<span class="string">"MAX: %f AVG: %f\nWAVELENGTH AT MAX: %f nm\n"</span>, maxSpec, avgSpec, maxWave);<br>
                            <br>
                            <span class="reserved">seabreeze_close_spectrometer</span>(0, &amp;errorCode); //Closes device<br>
                            fclose(csv); //Closes spectrum file<br>
                            <br>
                            return 0;<br>
                            }<br>
                        </code>
                    </div>
                </div>
            </div>
            <div class="panel panel default">
                <div class="row panel-heading" id="example1Head">

                    <div class="col-xs-3"><a href="color.c" download="color.c"><span class="glyphicon glyphicon-download"></span> Color.c</a></div>
                    <div class="col-xs-1">&nbsp;</div>
                    <div class="col-xs-8"><h4>color.c</h4></div>
                </div>
                <div class="row panel-body" id="example1Body">
                    <div class = "col-xs-1">
                        <code class="lineNumbers">
                            1<br>
                            2<br>
                            3<br>
                            4<br>
                            5<br>
                            6<br>
                            7<br>
                            8<br>
                            9<br>
                            10<br>
                            11<br>
                            12<br>
                            13<br>
                            14<br>
                            15<br>
                            16<br>
                            17<br>
                            18<br>
                            19<br>
                            20<br>
                            21<br>
                            22<br>
                            23<br>
                            24<br>
                            25<br>
                            26<br>
                            27<br>
                            28<br>
                            29<br>
                            30<br>
                            31<br>
                            32<br>
                            33<br>
                            34<br>
                            35<br>
                            36<br>
                            37<br>
                            38<br>
                            39<br>
                            40<br>
                            41<br>
                            42<br>
                            43<br>
                            44<br>
                            45<br>
                            46<br>
                            47<br>
                            48<br>
                            49<br>
                            50<br>
                            51<br>
                            52<br>
                            53<br>
                            54<br>
                            55<br>
                            56<br>
                            57<br>
                            58<br>
                            59<br>
                            60<br>
                            61<br>
                            62<br>
                            63<br>
                            64<br>
                            65<br>
                            66<br>
                            67<br>
                            68<br>
                            69<br>
                            70<br>
                            71<br>
                            72<br>
                            73<br>
                            74<br>
                            75<br>
                            76<br>
                            77<br>
                            78<br>
                            79<br>
                            80<br>
                        </code>
                    </div>
                    <div class="col-xs-11">
                        <code>
                            /* <br>
                            * This program takes input from the spectrometer, then based on its spectrum readings,<br>
                            * it determines the color of an LED it is pointed at.<br>
                            * As is, the program just runs until you kill the window it's in. Not important to make it pretty,<br>
                            * but it'd be hella cool <span class="reserved">if</span> we did.<br>
                            */<br>
                            <br>
                            #include &lt;stdio.h&gt;<br>
                            #include &lt;stdlib.h&gt;<br>
                            #include &lt;string.h&gt;<br>
                            #include &lt;pthread.h&gt;<br>
                            #include &lt;time.h&gt;<br>
                            #include &lt;sys/time.h&gt;<br>
                            #include &lt;errno.h&gt;<br>
                            #include <span class="string">"api/SeaBreezeWrapper.h"</span><br>
                            #include &lt;unistd.h&gt;<br>
                            <br>
                            <span class="declare">int</span> getColor();<br>
                            <br>
                            <span class="declare">char</span> *colors[] ={<br>
                            <span class="string">"BLACK"</span>,<br>
                            <span class="string">"RED"</span>,<br>
                            <span class="string">"ORANGE"</span>,<br>
                            <span class="string">"YELLOW"</span>,<br>
                            <span class="string">"GREEN"</span>,<br>
                            <span class="string">"BLUE"</span>,<br>
                            <span class="string">"WHITE"</span><br>
                            };<br>
                            <span class="declare">double</span> waveStart[11] ={<br>
                            99999, 780, 622, 597, 577, 492, 455, 390, 0<br>
                            };<br>
                            <br>
                            <span class="declare">int</span> errorCode;<br>
                            <br>
                            <span class="declare">int</span> main() {<br>
                            <span class="declare">int</span> open = <span class="reserved">seabreeze_open_spectrometer</span>(0,&amp;errorCode); //Opens device attached to system <span class="reserved">if</span> there is one<br>
                            <span class="reserved">if</span> (open == 0) {<br>
                            <span class="reserved">for</span> (;;) {<br>
                            getColor();<br>
                            sleep(1); //Waits one second before getting color again<br>
                            }<br>
                            <span class="reserved">seabreeze_close_spectrometer</span>(0, &amp;errorCode); //CLoses device<br>
                            }<br>
                            <span class="reserved">else</span> //Exits program <span class="reserved">if</span> no device is opened<br>
                            <span class="reserved">printf</span>(<span class="string">"--NO SPECTROMETER FOUND--\n"</span>);<br>
                            return 0;<br>
                            }<br>
                            <br>
                            <span class="declare">int</span> getColor() {<br>
                            <br>
                            <span class="declare">double</span> maxSpec = 0;<br>
                            <span class="declare">double</span> maxWave = 0;<br>
                            <span class="declare">char</span> model[16];<br>
                            <br>
                            <span class="declare">int</span> pixels = <span class="reserved">seabreeze_get_formatted_spectrum_length</span>(0, &amp;errorCode); //Acquires a spectrum and returns answer in formatted floats<br>
                            <br>
                            <span class="declare">double</span> *wavelength = (double*) malloc(pixels * <span class="reserved">sizeof</span>(<span class="declare">double</span>));<br>
                            <span class="reserved">seabreeze_get_wavelengths</span>(0,&amp;errorCode,wavelength,pixels); //Computes wavelengths <span class="reserved">for</span> the spectrometer and fills <span class="string">"wavelength" array with those values up to "pixels"</span> value<br>
                            <br>
                            <span class="declare">double</span> *spectrum = (double*) malloc(pixels * <span class="reserved">sizeof</span>(<span class="declare">double</span>));<br>
                            <span class="reserved">seabreeze_get_formatted_spectrum</span>(0,&amp;errorCode,spectrum,pixels); //Acquires the spectrum and returns in formatted floats and places this in the <span class="string">"spectrum" array up to "pixels"</span> value<br>
                            <br>
                            <span class="reserved">for</span>(<span class="declare">int</span> i = 0; i&lt;pixels; i += 5){<br>
                            <span class="reserved">for</span>(<span class="declare">int</span> k = 0; k &lt; 5 &amp;&amp; k+i&lt;pixels; k++){<br>
                            <span class="reserved">if</span> (maxSpec &lt; spectrum[k+i] &amp; k + i &gt; 1) {<br>
                            maxSpec = spectrum[k+i];<br>
                            maxWave = wavelength[k+i];<br>
                            }<br>
                            }<br>
                            }<br>
                            <span class="declare">int</span> LED = 0;<br>
                            <span class="reserved">for</span> (<span class="declare">int</span> i = 0; i &lt; 8; i++) { //Compares wavelength of max spectrum reading to determine color based on colors array<br>
                            <span class="reserved">if</span> (maxWave &lt; waveStart[i] &amp;&amp; maxWave &gt;= waveStart[i + 1] &amp;&amp; maxSpec &gt; 5000 &amp;&amp; LED == 0) {<br>
                            <span class="reserved">printf</span>(<span class="string">"%s\n"</span>, colors[i]);<br>
                            LED = 1;<br>
                            }<br>
                            }<br>
                            <span class="reserved">if</span> (LED == 0) //If light source is not bright enough<br>
                            <span class="reserved">printf</span>(<span class="string">"NO LED\n"</span>);<br>
                            }<br>
                        </code>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>